{% extends authorize_check %}
{% load static %}

{% block styles %}
<title> Коворкинги | {{ name_coworking }} </title>
<link rel="stylesheet" href="{% static 'main/css/coworking.css' %}"> <!--Ярик, тут меняй css на профиль css который создашь
+ посмотри там другие css и скопируй из них переменные для цветов(они правда называются по-ублюдски но ты можешь поменять названия в своем css)-->
{% endblock %}

{% block content %}


<div class="container">
    <div class="left-image">
        <img src="{{big_img.file.url}}" alt="Left Image">
    </div>

    <div class="right-images">
        {% for item in small_img %}
            <img src="{{item.file.url}}" alt="Right Image 1">
        {% endfor %}

    </div>
    
</div>
<div class="text-container">
    <div class="text-box">
        <div style="display: flex; flex-direction: row; align-items: center;">
            <h2>{{name_coworking}}</h2>
            <div class="score" style="margin-left: 20px;">
                <div class="heart-icon" ><img src="{% static 'main/img/heart.png' %}" alt="Right Image 1"></div>
                <h4>{{ value.rating }}</h4>
            </div>
        </div>
        <p>{{description}}</p>
    </div>
</div>
<hr class="line">
<div class="text-container">
    <div class="overview">
        <h2 style="margin-left: 20px;">Условия работы</h2>
        <div class="item">
            <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
            <p>Высокоскоростной интернет</p>
        </div>
        <div class="item">
            <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
            <p>Бесплатный обед</p>
        </div>
    </div>
</div>
<div class="spaces-h1">
<h2 style="margin-left: 50px;">Spaces</h2>
    <div class="spaces">
        
        {% for item in spaces %}
        <div class="two_window">
            <div id="overlay" class="overlay"></div>

            <div class="book-window" id="book-window">
                    <button class="close" id="closePopup">X</button>
                    <h1 style="margin-top: -40px;">{{item.type}}</h1>
                    <h4>{{item.num_of_seats}} человека</h4>
                    <h3>ФИО</h3>
                    <div class="container-space" style="height: 224px; width: 100%; display: flex; margin-left: 0px;">
                        <div class="space-img" style="height: 212px;" ><img src='{{item.img.url}}' alt="Right Image 1"></div>
                        <div class="accept-book" id="accept-book" style="display: none;">
                            <h1 style="margin-left: 80px ; margin-top: 90px;">Бронь прошла успешно</h1>
                            <h4 id="output" style="margin-left: 160px;">Вы можете закрыть это окно</h4>
                        </div>

                        <div class="right-box" id="norm-book" style="width: 520px; margin-left: 10px;">
                            <form id="book-service" method="POST">
                                {% csrf_token %}
                                <div class="time-input">
                                    <div class="time-box">
                                        <label for="date-input">Выберите дату:</label>
                                        <input type="date" id="date-input" name="date-input" required>
                                    </div>
                                    <div class="time-box">
                                        <label for="time-input">Выберите время:</label>
                                        <div class="ttt">
                                            <div class= "tt" style="display: flex; flex-direction: row; justify-content: center;">
                                            <p style="margin-right: 10px; margin-left: -20px; margin-top: 28px;">Начало</p>
                                            <input type="time" id="time-input" name="time-input" required>
                                        </div>
                                            <div class= "tt" style="display: flex; flex-direction: row;margin-right: 17px; margin-top: -10px;">
                                                <p style="margin-right: 10px; margin-left: -13  px; margin-top: 8px;">Конец</p>
                                            <input type="time" id="time-input2" name="time-input2" style="margin-left: 10px; margin-top: 0px;" required>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="submit" class="BookBtn" id="accept-book-btn" style="height: 45px; margin-top: 3px; width: 94%; margin-left: 20px;">Подтвердить бронирование</button>
                            </form>
                        </div>
                    </div>

            </div>


            <div class="container-space">
                <div class="space-img" ><img src='{{item.img.url}}' alt="Right Image 1"></div>
                <h2 style="margin-left: 10px;">{{item.type}}</h2>
                <h4>{{item.price}}</h4>
                <h4>{{item.num_of_seats}} человека</h4>
                <button type="submit" id="openPopup" class="BookBtn">Забронировать</button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<div class="1container">
    <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
        <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
        <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
        <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
        <img class="icon-img" src="{% static 'main/img/notebook.png' %}" alt="Right Image 1">
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>

</script>
<script>
    servicess = document.querySelectorAll(".two_window")

    servicess.forEach(container => {
        btnopen = container.querySelectorAll('.BookBtn')
        btnopen = btnopen[1]
        btnopen.addEventListener('click', function() {
            container.querySelector('.book-window').style.display = 'block';
            container.querySelector('.overlay').style.display = 'block';
        });
        container.querySelector('#closePopup').addEventListener('click', function() {
        container.querySelector('#book-window').style.display = 'none';
        container.querySelector('#overlay').style.display = 'none';
        });

        $(document).ready(function() {
            $('#book-service').submit(function(event) {
                event.preventDefault();
                var formData = $(this).serialize();
                $.ajax({
                    url: '/coworking/{{ key }}',
                    method: 'POST',
                    data: formData,
                    success: function(response) {
                        dateTime = `${dateInput} ${timeInput}:00`;
                        container.querySelector('#output').innerText = `Выбранное время: ${dateTime}`;
                        container.querySelector('#accept-book').style.display = 'block';
                        container.querySelector('#norm-book').style.display = 'none';
                    },
                    error: function(xhr, status, error) {
                        var errors = JSON.parse(xhr.responseText).error;
                        if (errors.password) {
                            $('#error-password-user').show();
                        } else {
                            $('#error-password-user').hide();
                        }
                    }
                });
            });
        });
    })

</script>
{% endblock %}